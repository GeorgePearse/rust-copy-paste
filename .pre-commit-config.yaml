repos:
  # Rust linting with clippy
  - repo: local
    hooks:
      - id: clippy
        name: clippy
        description: Run clippy with correctness and performance checks
        entry: cargo clippy
        language: system
        types: [rust]
        pass_filenames: false
        stages: [pre-commit]
        # Run clippy: treat correctness/performance as errors, warn on style issues
        args:
          - "--lib"
          - "--"
          - "-D"
          - "clippy::correctness,clippy::perf"
          - "-W"
          - "clippy::style,clippy::pedantic"

  # Rust formatting
  - repo: local
    hooks:
      - id: rustfmt
        name: rustfmt
        description: Format Rust code
        entry: cargo fmt
        language: system
        types: [rust]
        pass_filenames: false
        stages: [pre-commit]
        args: ["--all"]

  # Rust tests
  - repo: local
    hooks:
      - id: cargo-test
        name: cargo test
        description: Run Rust tests
        entry: cargo test
        language: system
        types: [rust]
        pass_filenames: false
        stages: [pre-commit]
        args: ["--lib", "--"]

  # Python linting
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.1.5
    hooks:
      - id: ruff
        args: [--fix]
      - id: ruff-format
