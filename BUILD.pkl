amends "@grog/package.pkl"

local py_sources = List(
  "copy_paste/**/*",
  "pyproject.toml"
)

// @inferred_deps
local inferred_deps = List(
  "//machine_learning/packages/viscv",
  "//machine_learning/packages/visdet"
)

targets {
  new {
    name = "copy_paste"
    inputs {
      ...py_sources
    }
    dependencies {
      ...inferred_deps
    }
  }

  new {
    name = "test"
    command = "uv run pytest"
    inputs {
      ...py_sources
      "tests/**/*"
    }

    dependencies {
      ...inferred_deps
      "//tools:uv"
    }

    platform {
      os {
        "linux"
      }
      arch {
        "amd64"
      }
    }
  }
}
