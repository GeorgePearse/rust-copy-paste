/home/georgepearse/.local/lib/python3.9/site-packages/pytest_asyncio/plugin.py:252: PytestDeprecationWarning: The configuration option "asyncio_default_fixture_loop_scope" is unset.
The event loop scope for asynchronous fixtures will default to the fixture caching scope. Future versions of pytest-asyncio will default the loop scope for asynchronous fixtures to function scope. Set the default fixture loop scope explicitly in order to avoid unexpected behavior in the future. Valid fixture loop scopes are: "function", "class", "module", "package", "session"

  warnings.warn(PytestDeprecationWarning(_DEFAULT_FIXTURE_LOOP_SCOPE_UNSET))
============================= test session starts ==============================
platform linux -- Python 3.9.2, pytest-8.3.5, pluggy-1.6.0
benchmark: 5.1.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
rootdir: /home/georgepearse/rust-copy-paste
configfile: pyproject.toml
plugins: cov-6.1.1, asyncio-1.2.0, hypothesis-6.141.1, benchmark-5.1.0, anyio-4.8.0, jaxtyping-0.2.36, timeout-2.4.0
asyncio: mode=strict, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collected 18 items

tests/test_albumentations_transform.py EEEEEEFFFFFFFEEEFE                [100%]

==================================== ERRORS ====================================
_______________ ERROR at setup of test_transform_initialization ________________

    @pytest.fixture
    def sample_transform():
        """Create a basic CopyPasteAugmentation transform."""
>       return CopyPasteAugmentation(
            image_width=512,
            image_height=512,
            max_paste_objects=1,
            use_rotation=False,
            use_scaling=False,
            use_random_background=False,
            p=1.0,
        )

tests/test_albumentations_transform.py:17: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = CopyPasteAugmentation(p=1.0), image_width = 512, image_height = 512
max_paste_objects = 1, use_rotation = False, use_scaling = False
rotation_range = (-30.0, 30.0), scale_range = (0.8, 1.2)
use_random_background = False, blend_mode = 'normal', object_counts = None
p = 1.0

    def __init__(
        self,
        image_width: int = 512,
        image_height: int = 512,
        max_paste_objects: int = 1,
        use_rotation: bool = True,
        use_scaling: bool = True,
        rotation_range: tuple[float, float] = (-30.0, 30.0),
        scale_range: tuple[float, float] = (0.8, 1.2),
        use_random_background: bool = False,
        blend_mode: str = "normal",
        object_counts: Optional[Dict[str, int]] = None,
        p: float = 1.0,
    ):
        """Initialize the CopyPasteAugmentation transform.
    
        Args:
            object_counts: Optional dict mapping class names (str) to exact number of objects
                          to paste per class. Example: {'person': 2, 'car': 1}
                          If None, no per-class count constraint is applied.
        """
        super().__init__(p=p)
    
        if not RUST_AVAILABLE:
>           raise RuntimeError(
                "Rust implementation not available. "
                "Build with: pip install -e . or maturin develop"
            )
E           RuntimeError: Rust implementation not available. Build with: pip install -e . or maturin develop

copy_paste/transform.py:74: RuntimeError
______________ ERROR at setup of test_transform_is_dual_transform ______________

    @pytest.fixture
    def sample_transform():
        """Create a basic CopyPasteAugmentation transform."""
>       return CopyPasteAugmentation(
            image_width=512,
            image_height=512,
            max_paste_objects=1,
            use_rotation=False,
            use_scaling=False,
            use_random_background=False,
            p=1.0,
        )

tests/test_albumentations_transform.py:17: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = CopyPasteAugmentation(p=1.0), image_width = 512, image_height = 512
max_paste_objects = 1, use_rotation = False, use_scaling = False
rotation_range = (-30.0, 30.0), scale_range = (0.8, 1.2)
use_random_background = False, blend_mode = 'normal', object_counts = None
p = 1.0

    def __init__(
        self,
        image_width: int = 512,
        image_height: int = 512,
        max_paste_objects: int = 1,
        use_rotation: bool = True,
        use_scaling: bool = True,
        rotation_range: tuple[float, float] = (-30.0, 30.0),
        scale_range: tuple[float, float] = (0.8, 1.2),
        use_random_background: bool = False,
        blend_mode: str = "normal",
        object_counts: Optional[Dict[str, int]] = None,
        p: float = 1.0,
    ):
        """Initialize the CopyPasteAugmentation transform.
    
        Args:
            object_counts: Optional dict mapping class names (str) to exact number of objects
                          to paste per class. Example: {'person': 2, 'car': 1}
                          If None, no per-class count constraint is applied.
        """
        super().__init__(p=p)
    
        if not RUST_AVAILABLE:
>           raise RuntimeError(
                "Rust implementation not available. "
                "Build with: pip install -e . or maturin develop"
            )
E           RuntimeError: Rust implementation not available. Build with: pip install -e . or maturin develop

copy_paste/transform.py:74: RuntimeError
___________________ ERROR at setup of test_apply_basic_image ___________________

    @pytest.fixture
    def sample_transform():
        """Create a basic CopyPasteAugmentation transform."""
>       return CopyPasteAugmentation(
            image_width=512,
            image_height=512,
            max_paste_objects=1,
            use_rotation=False,
            use_scaling=False,
            use_random_background=False,
            p=1.0,
        )

tests/test_albumentations_transform.py:17: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = CopyPasteAugmentation(p=1.0), image_width = 512, image_height = 512
max_paste_objects = 1, use_rotation = False, use_scaling = False
rotation_range = (-30.0, 30.0), scale_range = (0.8, 1.2)
use_random_background = False, blend_mode = 'normal', object_counts = None
p = 1.0

    def __init__(
        self,
        image_width: int = 512,
        image_height: int = 512,
        max_paste_objects: int = 1,
        use_rotation: bool = True,
        use_scaling: bool = True,
        rotation_range: tuple[float, float] = (-30.0, 30.0),
        scale_range: tuple[float, float] = (0.8, 1.2),
        use_random_background: bool = False,
        blend_mode: str = "normal",
        object_counts: Optional[Dict[str, int]] = None,
        p: float = 1.0,
    ):
        """Initialize the CopyPasteAugmentation transform.
    
        Args:
            object_counts: Optional dict mapping class names (str) to exact number of objects
                          to paste per class. Example: {'person': 2, 'car': 1}
                          If None, no per-class count constraint is applied.
        """
        super().__init__(p=p)
    
        if not RUST_AVAILABLE:
>           raise RuntimeError(
                "Rust implementation not available. "
                "Build with: pip install -e . or maturin develop"
            )
E           RuntimeError: Rust implementation not available. Build with: pip install -e . or maturin develop

copy_paste/transform.py:74: RuntimeError
____________________ ERROR at setup of test_apply_to_bboxes ____________________

    @pytest.fixture
    def sample_transform():
        """Create a basic CopyPasteAugmentation transform."""
>       return CopyPasteAugmentation(
            image_width=512,
            image_height=512,
            max_paste_objects=1,
            use_rotation=False,
            use_scaling=False,
            use_random_background=False,
            p=1.0,
        )

tests/test_albumentations_transform.py:17: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = CopyPasteAugmentation(p=1.0), image_width = 512, image_height = 512
max_paste_objects = 1, use_rotation = False, use_scaling = False
rotation_range = (-30.0, 30.0), scale_range = (0.8, 1.2)
use_random_background = False, blend_mode = 'normal', object_counts = None
p = 1.0

    def __init__(
        self,
        image_width: int = 512,
        image_height: int = 512,
        max_paste_objects: int = 1,
        use_rotation: bool = True,
        use_scaling: bool = True,
        rotation_range: tuple[float, float] = (-30.0, 30.0),
        scale_range: tuple[float, float] = (0.8, 1.2),
        use_random_background: bool = False,
        blend_mode: str = "normal",
        object_counts: Optional[Dict[str, int]] = None,
        p: float = 1.0,
    ):
        """Initialize the CopyPasteAugmentation transform.
    
        Args:
            object_counts: Optional dict mapping class names (str) to exact number of objects
                          to paste per class. Example: {'person': 2, 'car': 1}
                          If None, no per-class count constraint is applied.
        """
        super().__init__(p=p)
    
        if not RUST_AVAILABLE:
>           raise RuntimeError(
                "Rust implementation not available. "
                "Build with: pip install -e . or maturin develop"
            )
E           RuntimeError: Rust implementation not available. Build with: pip install -e . or maturin develop

copy_paste/transform.py:74: RuntimeError
____________________ ERROR at setup of test_apply_to_masks _____________________

    @pytest.fixture
    def sample_transform():
        """Create a basic CopyPasteAugmentation transform."""
>       return CopyPasteAugmentation(
            image_width=512,
            image_height=512,
            max_paste_objects=1,
            use_rotation=False,
            use_scaling=False,
            use_random_background=False,
            p=1.0,
        )

tests/test_albumentations_transform.py:17: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = CopyPasteAugmentation(p=1.0), image_width = 512, image_height = 512
max_paste_objects = 1, use_rotation = False, use_scaling = False
rotation_range = (-30.0, 30.0), scale_range = (0.8, 1.2)
use_random_background = False, blend_mode = 'normal', object_counts = None
p = 1.0

    def __init__(
        self,
        image_width: int = 512,
        image_height: int = 512,
        max_paste_objects: int = 1,
        use_rotation: bool = True,
        use_scaling: bool = True,
        rotation_range: tuple[float, float] = (-30.0, 30.0),
        scale_range: tuple[float, float] = (0.8, 1.2),
        use_random_background: bool = False,
        blend_mode: str = "normal",
        object_counts: Optional[Dict[str, int]] = None,
        p: float = 1.0,
    ):
        """Initialize the CopyPasteAugmentation transform.
    
        Args:
            object_counts: Optional dict mapping class names (str) to exact number of objects
                          to paste per class. Example: {'person': 2, 'car': 1}
                          If None, no per-class count constraint is applied.
        """
        super().__init__(p=p)
    
        if not RUST_AVAILABLE:
>           raise RuntimeError(
                "Rust implementation not available. "
                "Build with: pip install -e . or maturin develop"
            )
E           RuntimeError: Rust implementation not available. Build with: pip install -e . or maturin develop

copy_paste/transform.py:74: RuntimeError
__________________ ERROR at setup of test_full_transform_call __________________

    @pytest.fixture
    def sample_transform():
        """Create a basic CopyPasteAugmentation transform."""
>       return CopyPasteAugmentation(
            image_width=512,
            image_height=512,
            max_paste_objects=1,
            use_rotation=False,
            use_scaling=False,
            use_random_background=False,
            p=1.0,
        )

tests/test_albumentations_transform.py:17: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = CopyPasteAugmentation(p=1.0), image_width = 512, image_height = 512
max_paste_objects = 1, use_rotation = False, use_scaling = False
rotation_range = (-30.0, 30.0), scale_range = (0.8, 1.2)
use_random_background = False, blend_mode = 'normal', object_counts = None
p = 1.0

    def __init__(
        self,
        image_width: int = 512,
        image_height: int = 512,
        max_paste_objects: int = 1,
        use_rotation: bool = True,
        use_scaling: bool = True,
        rotation_range: tuple[float, float] = (-30.0, 30.0),
        scale_range: tuple[float, float] = (0.8, 1.2),
        use_random_background: bool = False,
        blend_mode: str = "normal",
        object_counts: Optional[Dict[str, int]] = None,
        p: float = 1.0,
    ):
        """Initialize the CopyPasteAugmentation transform.
    
        Args:
            object_counts: Optional dict mapping class names (str) to exact number of objects
                          to paste per class. Example: {'person': 2, 'car': 1}
                          If None, no per-class count constraint is applied.
        """
        super().__init__(p=p)
    
        if not RUST_AVAILABLE:
>           raise RuntimeError(
                "Rust implementation not available. "
                "Build with: pip install -e . or maturin develop"
            )
E           RuntimeError: Rust implementation not available. Build with: pip install -e . or maturin develop

copy_paste/transform.py:74: RuntimeError
_____________ ERROR at setup of test_get_transform_init_args_names _____________

    @pytest.fixture
    def sample_transform():
        """Create a basic CopyPasteAugmentation transform."""
>       return CopyPasteAugmentation(
            image_width=512,
            image_height=512,
            max_paste_objects=1,
            use_rotation=False,
            use_scaling=False,
            use_random_background=False,
            p=1.0,
        )

tests/test_albumentations_transform.py:17: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = CopyPasteAugmentation(p=1.0), image_width = 512, image_height = 512
max_paste_objects = 1, use_rotation = False, use_scaling = False
rotation_range = (-30.0, 30.0), scale_range = (0.8, 1.2)
use_random_background = False, blend_mode = 'normal', object_counts = None
p = 1.0

    def __init__(
        self,
        image_width: int = 512,
        image_height: int = 512,
        max_paste_objects: int = 1,
        use_rotation: bool = True,
        use_scaling: bool = True,
        rotation_range: tuple[float, float] = (-30.0, 30.0),
        scale_range: tuple[float, float] = (0.8, 1.2),
        use_random_background: bool = False,
        blend_mode: str = "normal",
        object_counts: Optional[Dict[str, int]] = None,
        p: float = 1.0,
    ):
        """Initialize the CopyPasteAugmentation transform.
    
        Args:
            object_counts: Optional dict mapping class names (str) to exact number of objects
                          to paste per class. Example: {'person': 2, 'car': 1}
                          If None, no per-class count constraint is applied.
        """
        super().__init__(p=p)
    
        if not RUST_AVAILABLE:
>           raise RuntimeError(
                "Rust implementation not available. "
                "Build with: pip install -e . or maturin develop"
            )
E           RuntimeError: Rust implementation not available. Build with: pip install -e . or maturin develop

copy_paste/transform.py:74: RuntimeError
_________________ ERROR at setup of test_image_dtype_handling __________________

    @pytest.fixture
    def sample_transform():
        """Create a basic CopyPasteAugmentation transform."""
>       return CopyPasteAugmentation(
            image_width=512,
            image_height=512,
            max_paste_objects=1,
            use_rotation=False,
            use_scaling=False,
            use_random_background=False,
            p=1.0,
        )

tests/test_albumentations_transform.py:17: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = CopyPasteAugmentation(p=1.0), image_width = 512, image_height = 512
max_paste_objects = 1, use_rotation = False, use_scaling = False
rotation_range = (-30.0, 30.0), scale_range = (0.8, 1.2)
use_random_background = False, blend_mode = 'normal', object_counts = None
p = 1.0

    def __init__(
        self,
        image_width: int = 512,
        image_height: int = 512,
        max_paste_objects: int = 1,
        use_rotation: bool = True,
        use_scaling: bool = True,
        rotation_range: tuple[float, float] = (-30.0, 30.0),
        scale_range: tuple[float, float] = (0.8, 1.2),
        use_random_background: bool = False,
        blend_mode: str = "normal",
        object_counts: Optional[Dict[str, int]] = None,
        p: float = 1.0,
    ):
        """Initialize the CopyPasteAugmentation transform.
    
        Args:
            object_counts: Optional dict mapping class names (str) to exact number of objects
                          to paste per class. Example: {'person': 2, 'car': 1}
                          If None, no per-class count constraint is applied.
        """
        super().__init__(p=p)
    
        if not RUST_AVAILABLE:
>           raise RuntimeError(
                "Rust implementation not available. "
                "Build with: pip install -e . or maturin develop"
            )
E           RuntimeError: Rust implementation not available. Build with: pip install -e . or maturin develop

copy_paste/transform.py:74: RuntimeError
_____________________ ERROR at setup of test_empty_bboxes ______________________

    @pytest.fixture
    def sample_transform():
        """Create a basic CopyPasteAugmentation transform."""
>       return CopyPasteAugmentation(
            image_width=512,
            image_height=512,
            max_paste_objects=1,
            use_rotation=False,
            use_scaling=False,
            use_random_background=False,
            p=1.0,
        )

tests/test_albumentations_transform.py:17: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = CopyPasteAugmentation(p=1.0), image_width = 512, image_height = 512
max_paste_objects = 1, use_rotation = False, use_scaling = False
rotation_range = (-30.0, 30.0), scale_range = (0.8, 1.2)
use_random_background = False, blend_mode = 'normal', object_counts = None
p = 1.0

    def __init__(
        self,
        image_width: int = 512,
        image_height: int = 512,
        max_paste_objects: int = 1,
        use_rotation: bool = True,
        use_scaling: bool = True,
        rotation_range: tuple[float, float] = (-30.0, 30.0),
        scale_range: tuple[float, float] = (0.8, 1.2),
        use_random_background: bool = False,
        blend_mode: str = "normal",
        object_counts: Optional[Dict[str, int]] = None,
        p: float = 1.0,
    ):
        """Initialize the CopyPasteAugmentation transform.
    
        Args:
            object_counts: Optional dict mapping class names (str) to exact number of objects
                          to paste per class. Example: {'person': 2, 'car': 1}
                          If None, no per-class count constraint is applied.
        """
        super().__init__(p=p)
    
        if not RUST_AVAILABLE:
>           raise RuntimeError(
                "Rust implementation not available. "
                "Build with: pip install -e . or maturin develop"
            )
E           RuntimeError: Rust implementation not available. Build with: pip install -e . or maturin develop

copy_paste/transform.py:74: RuntimeError
______________________ ERROR at setup of test_empty_masks ______________________

    @pytest.fixture
    def sample_transform():
        """Create a basic CopyPasteAugmentation transform."""
>       return CopyPasteAugmentation(
            image_width=512,
            image_height=512,
            max_paste_objects=1,
            use_rotation=False,
            use_scaling=False,
            use_random_background=False,
            p=1.0,
        )

tests/test_albumentations_transform.py:17: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = CopyPasteAugmentation(p=1.0), image_width = 512, image_height = 512
max_paste_objects = 1, use_rotation = False, use_scaling = False
rotation_range = (-30.0, 30.0), scale_range = (0.8, 1.2)
use_random_background = False, blend_mode = 'normal', object_counts = None
p = 1.0

    def __init__(
        self,
        image_width: int = 512,
        image_height: int = 512,
        max_paste_objects: int = 1,
        use_rotation: bool = True,
        use_scaling: bool = True,
        rotation_range: tuple[float, float] = (-30.0, 30.0),
        scale_range: tuple[float, float] = (0.8, 1.2),
        use_random_background: bool = False,
        blend_mode: str = "normal",
        object_counts: Optional[Dict[str, int]] = None,
        p: float = 1.0,
    ):
        """Initialize the CopyPasteAugmentation transform.
    
        Args:
            object_counts: Optional dict mapping class names (str) to exact number of objects
                          to paste per class. Example: {'person': 2, 'car': 1}
                          If None, no per-class count constraint is applied.
        """
        super().__init__(p=p)
    
        if not RUST_AVAILABLE:
>           raise RuntimeError(
                "Rust implementation not available. "
                "Build with: pip install -e . or maturin develop"
            )
E           RuntimeError: Rust implementation not available. Build with: pip install -e . or maturin develop

copy_paste/transform.py:74: RuntimeError
=================================== FAILURES ===================================
_________________________ test_simple_copy_paste_alias _________________________

    def test_simple_copy_paste_alias():
        """Test that SimpleCopyPaste alias works."""
>       transform = SimpleCopyPaste(
            image_width=256,
            image_height=256,
            max_paste_objects=1,
            p=1.0,
        )

tests/test_albumentations_transform.py:106: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = CopyPasteAugmentation(p=1.0), image_width = 256, image_height = 256
max_paste_objects = 1, use_rotation = True, use_scaling = True
rotation_range = (-30.0, 30.0), scale_range = (0.8, 1.2)
use_random_background = False, blend_mode = 'normal', object_counts = None
p = 1.0

    def __init__(
        self,
        image_width: int = 512,
        image_height: int = 512,
        max_paste_objects: int = 1,
        use_rotation: bool = True,
        use_scaling: bool = True,
        rotation_range: tuple[float, float] = (-30.0, 30.0),
        scale_range: tuple[float, float] = (0.8, 1.2),
        use_random_background: bool = False,
        blend_mode: str = "normal",
        object_counts: Optional[Dict[str, int]] = None,
        p: float = 1.0,
    ):
        """Initialize the CopyPasteAugmentation transform.
    
        Args:
            object_counts: Optional dict mapping class names (str) to exact number of objects
                          to paste per class. Example: {'person': 2, 'car': 1}
                          If None, no per-class count constraint is applied.
        """
        super().__init__(p=p)
    
        if not RUST_AVAILABLE:
>           raise RuntimeError(
                "Rust implementation not available. "
                "Build with: pip install -e . or maturin develop"
            )
E           RuntimeError: Rust implementation not available. Build with: pip install -e . or maturin develop

copy_paste/transform.py:74: RuntimeError
_____________________ test_transform_with_different_sizes ______________________

    def test_transform_with_different_sizes():
        """Test transform with various image sizes."""
        sizes = [(256, 256), (512, 512), (1024, 1024)]
    
        for height, width in sizes:
>           transform = CopyPasteAugmentation(
                image_width=width,
                image_height=height,
                p=1.0,
            )

tests/test_albumentations_transform.py:120: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = CopyPasteAugmentation(p=1.0), image_width = 256, image_height = 256
max_paste_objects = 1, use_rotation = True, use_scaling = True
rotation_range = (-30.0, 30.0), scale_range = (0.8, 1.2)
use_random_background = False, blend_mode = 'normal', object_counts = None
p = 1.0

    def __init__(
        self,
        image_width: int = 512,
        image_height: int = 512,
        max_paste_objects: int = 1,
        use_rotation: bool = True,
        use_scaling: bool = True,
        rotation_range: tuple[float, float] = (-30.0, 30.0),
        scale_range: tuple[float, float] = (0.8, 1.2),
        use_random_background: bool = False,
        blend_mode: str = "normal",
        object_counts: Optional[Dict[str, int]] = None,
        p: float = 1.0,
    ):
        """Initialize the CopyPasteAugmentation transform.
    
        Args:
            object_counts: Optional dict mapping class names (str) to exact number of objects
                          to paste per class. Example: {'person': 2, 'car': 1}
                          If None, no per-class count constraint is applied.
        """
        super().__init__(p=p)
    
        if not RUST_AVAILABLE:
>           raise RuntimeError(
                "Rust implementation not available. "
                "Build with: pip install -e . or maturin develop"
            )
E           RuntimeError: Rust implementation not available. Build with: pip install -e . or maturin develop

copy_paste/transform.py:74: RuntimeError
_______________________ test_transform_probability_zero ________________________

    def test_transform_probability_zero():
        """Test that transform with p=0 doesn't apply."""
>       transform = CopyPasteAugmentation(
            image_width=512,
            image_height=512,
            p=0.0,  # Never apply
        )

tests/test_albumentations_transform.py:132: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = CopyPasteAugmentation(p=0.0), image_width = 512, image_height = 512
max_paste_objects = 1, use_rotation = True, use_scaling = True
rotation_range = (-30.0, 30.0), scale_range = (0.8, 1.2)
use_random_background = False, blend_mode = 'normal', object_counts = None
p = 0.0

    def __init__(
        self,
        image_width: int = 512,
        image_height: int = 512,
        max_paste_objects: int = 1,
        use_rotation: bool = True,
        use_scaling: bool = True,
        rotation_range: tuple[float, float] = (-30.0, 30.0),
        scale_range: tuple[float, float] = (0.8, 1.2),
        use_random_background: bool = False,
        blend_mode: str = "normal",
        object_counts: Optional[Dict[str, int]] = None,
        p: float = 1.0,
    ):
        """Initialize the CopyPasteAugmentation transform.
    
        Args:
            object_counts: Optional dict mapping class names (str) to exact number of objects
                          to paste per class. Example: {'person': 2, 'car': 1}
                          If None, no per-class count constraint is applied.
        """
        super().__init__(p=p)
    
        if not RUST_AVAILABLE:
>           raise RuntimeError(
                "Rust implementation not available. "
                "Build with: pip install -e . or maturin develop"
            )
E           RuntimeError: Rust implementation not available. Build with: pip install -e . or maturin develop

copy_paste/transform.py:74: RuntimeError
_________________________ test_transform_with_rotation _________________________

    def test_transform_with_rotation():
        """Test transform with rotation enabled."""
>       transform = CopyPasteAugmentation(
            image_width=512,
            image_height=512,
            use_rotation=True,
            rotation_range=(-45.0, 45.0),
            p=1.0,
        )

tests/test_albumentations_transform.py:145: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = CopyPasteAugmentation(p=1.0), image_width = 512, image_height = 512
max_paste_objects = 1, use_rotation = True, use_scaling = True
rotation_range = (-45.0, 45.0), scale_range = (0.8, 1.2)
use_random_background = False, blend_mode = 'normal', object_counts = None
p = 1.0

    def __init__(
        self,
        image_width: int = 512,
        image_height: int = 512,
        max_paste_objects: int = 1,
        use_rotation: bool = True,
        use_scaling: bool = True,
        rotation_range: tuple[float, float] = (-30.0, 30.0),
        scale_range: tuple[float, float] = (0.8, 1.2),
        use_random_background: bool = False,
        blend_mode: str = "normal",
        object_counts: Optional[Dict[str, int]] = None,
        p: float = 1.0,
    ):
        """Initialize the CopyPasteAugmentation transform.
    
        Args:
            object_counts: Optional dict mapping class names (str) to exact number of objects
                          to paste per class. Example: {'person': 2, 'car': 1}
                          If None, no per-class count constraint is applied.
        """
        super().__init__(p=p)
    
        if not RUST_AVAILABLE:
>           raise RuntimeError(
                "Rust implementation not available. "
                "Build with: pip install -e . or maturin develop"
            )
E           RuntimeError: Rust implementation not available. Build with: pip install -e . or maturin develop

copy_paste/transform.py:74: RuntimeError
_________________________ test_transform_with_scaling __________________________

    def test_transform_with_scaling():
        """Test transform with scaling enabled."""
>       transform = CopyPasteAugmentation(
            image_width=512,
            image_height=512,
            use_scaling=True,
            scale_range=(0.8, 1.2),
            p=1.0,
        )

tests/test_albumentations_transform.py:160: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = CopyPasteAugmentation(p=1.0), image_width = 512, image_height = 512
max_paste_objects = 1, use_rotation = True, use_scaling = True
rotation_range = (-30.0, 30.0), scale_range = (0.8, 1.2)
use_random_background = False, blend_mode = 'normal', object_counts = None
p = 1.0

    def __init__(
        self,
        image_width: int = 512,
        image_height: int = 512,
        max_paste_objects: int = 1,
        use_rotation: bool = True,
        use_scaling: bool = True,
        rotation_range: tuple[float, float] = (-30.0, 30.0),
        scale_range: tuple[float, float] = (0.8, 1.2),
        use_random_background: bool = False,
        blend_mode: str = "normal",
        object_counts: Optional[Dict[str, int]] = None,
        p: float = 1.0,
    ):
        """Initialize the CopyPasteAugmentation transform.
    
        Args:
            object_counts: Optional dict mapping class names (str) to exact number of objects
                          to paste per class. Example: {'person': 2, 'car': 1}
                          If None, no per-class count constraint is applied.
        """
        super().__init__(p=p)
    
        if not RUST_AVAILABLE:
>           raise RuntimeError(
                "Rust implementation not available. "
                "Build with: pip install -e . or maturin develop"
            )
E           RuntimeError: Rust implementation not available. Build with: pip install -e . or maturin develop

copy_paste/transform.py:74: RuntimeError
____________________ test_transform_with_random_background _____________________

    def test_transform_with_random_background():
        """Test transform with random background generation."""
>       transform = CopyPasteAugmentation(
            image_width=512,
            image_height=512,
            use_random_background=True,
            p=1.0,
        )

tests/test_albumentations_transform.py:175: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = CopyPasteAugmentation(p=1.0), image_width = 512, image_height = 512
max_paste_objects = 1, use_rotation = True, use_scaling = True
rotation_range = (-30.0, 30.0), scale_range = (0.8, 1.2)
use_random_background = True, blend_mode = 'normal', object_counts = None
p = 1.0

    def __init__(
        self,
        image_width: int = 512,
        image_height: int = 512,
        max_paste_objects: int = 1,
        use_rotation: bool = True,
        use_scaling: bool = True,
        rotation_range: tuple[float, float] = (-30.0, 30.0),
        scale_range: tuple[float, float] = (0.8, 1.2),
        use_random_background: bool = False,
        blend_mode: str = "normal",
        object_counts: Optional[Dict[str, int]] = None,
        p: float = 1.0,
    ):
        """Initialize the CopyPasteAugmentation transform.
    
        Args:
            object_counts: Optional dict mapping class names (str) to exact number of objects
                          to paste per class. Example: {'person': 2, 'car': 1}
                          If None, no per-class count constraint is applied.
        """
        super().__init__(p=p)
    
        if not RUST_AVAILABLE:
>           raise RuntimeError(
                "Rust implementation not available. "
                "Build with: pip install -e . or maturin develop"
            )
E           RuntimeError: Rust implementation not available. Build with: pip install -e . or maturin develop

copy_paste/transform.py:74: RuntimeError
_____________________ test_transform_different_blend_modes _____________________

    def test_transform_different_blend_modes():
        """Test transform with different blend modes."""
        modes = ["normal", "xray"]
    
        for blend_mode in modes:
>           transform = CopyPasteAugmentation(
                image_width=512,
                image_height=512,
                blend_mode=blend_mode,
                p=1.0,
            )

tests/test_albumentations_transform.py:192: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = CopyPasteAugmentation(p=1.0), image_width = 512, image_height = 512
max_paste_objects = 1, use_rotation = True, use_scaling = True
rotation_range = (-30.0, 30.0), scale_range = (0.8, 1.2)
use_random_background = False, blend_mode = 'normal', object_counts = None
p = 1.0

    def __init__(
        self,
        image_width: int = 512,
        image_height: int = 512,
        max_paste_objects: int = 1,
        use_rotation: bool = True,
        use_scaling: bool = True,
        rotation_range: tuple[float, float] = (-30.0, 30.0),
        scale_range: tuple[float, float] = (0.8, 1.2),
        use_random_background: bool = False,
        blend_mode: str = "normal",
        object_counts: Optional[Dict[str, int]] = None,
        p: float = 1.0,
    ):
        """Initialize the CopyPasteAugmentation transform.
    
        Args:
            object_counts: Optional dict mapping class names (str) to exact number of objects
                          to paste per class. Example: {'person': 2, 'car': 1}
                          If None, no per-class count constraint is applied.
        """
        super().__init__(p=p)
    
        if not RUST_AVAILABLE:
>           raise RuntimeError(
                "Rust implementation not available. "
                "Build with: pip install -e . or maturin develop"
            )
E           RuntimeError: Rust implementation not available. Build with: pip install -e . or maturin develop

copy_paste/transform.py:74: RuntimeError
______________________ test_apply_to_bboxes_with_rotation ______________________

    def test_apply_to_bboxes_with_rotation():
        """Ensure rotation metadata propagates to bbox outputs."""
>       transform = CopyPasteAugmentation(
            image_width=64,
            image_height=64,
            max_paste_objects=1,
            use_rotation=True,
            rotation_range=(-45.0, -45.0),
            use_scaling=False,
            use_random_background=False,
            p=1.0,
        )

tests/test_albumentations_transform.py:247: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = CopyPasteAugmentation(p=1.0), image_width = 64, image_height = 64
max_paste_objects = 1, use_rotation = True, use_scaling = False
rotation_range = (-45.0, -45.0), scale_range = (0.8, 1.2)
use_random_background = False, blend_mode = 'normal', object_counts = None
p = 1.0

    def __init__(
        self,
        image_width: int = 512,
        image_height: int = 512,
        max_paste_objects: int = 1,
        use_rotation: bool = True,
        use_scaling: bool = True,
        rotation_range: tuple[float, float] = (-30.0, 30.0),
        scale_range: tuple[float, float] = (0.8, 1.2),
        use_random_background: bool = False,
        blend_mode: str = "normal",
        object_counts: Optional[Dict[str, int]] = None,
        p: float = 1.0,
    ):
        """Initialize the CopyPasteAugmentation transform.
    
        Args:
            object_counts: Optional dict mapping class names (str) to exact number of objects
                          to paste per class. Example: {'person': 2, 'car': 1}
                          If None, no per-class count constraint is applied.
        """
        super().__init__(p=p)
    
        if not RUST_AVAILABLE:
>           raise RuntimeError(
                "Rust implementation not available. "
                "Build with: pip install -e . or maturin develop"
            )
E           RuntimeError: Rust implementation not available. Build with: pip install -e . or maturin develop

copy_paste/transform.py:74: RuntimeError
=========================== short test summary info ============================
FAILED tests/test_albumentations_transform.py::test_simple_copy_paste_alias
FAILED tests/test_albumentations_transform.py::test_transform_with_different_sizes
FAILED tests/test_albumentations_transform.py::test_transform_probability_zero
FAILED tests/test_albumentations_transform.py::test_transform_with_rotation
FAILED tests/test_albumentations_transform.py::test_transform_with_scaling - ...
FAILED tests/test_albumentations_transform.py::test_transform_with_random_background
FAILED tests/test_albumentations_transform.py::test_transform_different_blend_modes
FAILED tests/test_albumentations_transform.py::test_apply_to_bboxes_with_rotation
ERROR tests/test_albumentations_transform.py::test_transform_initialization
ERROR tests/test_albumentations_transform.py::test_transform_is_dual_transform
ERROR tests/test_albumentations_transform.py::test_apply_basic_image - Runtim...
ERROR tests/test_albumentations_transform.py::test_apply_to_bboxes - RuntimeE...
ERROR tests/test_albumentations_transform.py::test_apply_to_masks - RuntimeEr...
ERROR tests/test_albumentations_transform.py::test_full_transform_call - Runt...
ERROR tests/test_albumentations_transform.py::test_get_transform_init_args_names
ERROR tests/test_albumentations_transform.py::test_image_dtype_handling - Run...
ERROR tests/test_albumentations_transform.py::test_empty_bboxes - RuntimeErro...
ERROR tests/test_albumentations_transform.py::test_empty_masks - RuntimeError...
========================= 8 failed, 10 errors in 2.98s =========================
